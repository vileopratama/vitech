<?xml version="1.0"?>
<openerp>
    <data>
       <!-- Top menu item -->
        <menuitem name="Lounge"
            id="menu_lounge_root"
            sequence="23"/>

        <record model="ir.ui.view" id="view_lounge_config_form">
            <field name="name">lounge.config.form.view</field>
            <field name="model">lounge.config</field>
            <field name="view_type">form</field>
            <field name="arch" type="xml">
                <form string="Lounge Configuration">
                    <header>
                        <button string="Set to Active" name="set_active" type="object" states="inactive,deprecated"/>
                        <button string="Set to Inactive" name="set_inactive" type="object" states="active" />
                        <button string="Set to Deprecated" name="set_deprecate" type="object" states="active,inactive" />
                        <field name="state" widget="statusbar" statusbar_visible="active,inactive,deprecated" statusbar_colors='{"deprecated" : "red"}' nolabel="1"/>
                    </header>
                    <sheet>
                        <label for="name" class="oe_edit_only"/>
                        <h1><field name="name"/></h1>
                        <group col="4">
                            <field name="picking_type_id" widget="selection" groups="stock.group_locations"
                                on_change="onchange_picking_type_id(picking_type_id)"/>
                            <field name="stock_location_id" groups="stock.group_locations"/>
                            <field name="company_id" groups="base.group_multi_company"/>
                            <field name="pricelist_id" groups="product.group_sale_pricelist"/>
                            <field name="journal_id" widget="selection"/>
                            <field name="group_by" groups="account.group_account_user"/>
                            <field name="barcode_nomenclature_id" />
                            <field name="sequence_id" readonly="1" groups="base.group_no_one"/>
                            <field name="fiscal_position_ids" widget="many2many_tags" options="{'no_create': True}"/>
                            <field name="currency_id" invisible="1"/>
                        </group>
                        <separator string="Available Payment Methods" colspan="4"/>
                        <field name="journal_ids" colspan="4" nolabel="1" context="{'default_journal_user': 1}">
                            <tree string="Journals">
                                <field name="code" />
                                <field name="name" />
                                <field name="type" />
                            </tree>
                        </field>
                         <group name="features" string="Features" >
                             <group>
                                 <field name="iface_vkeyboard" />
                                 <field name="iface_invoicing" />
                                 <field name="iface_precompute_cash" />
                                 <field name="iface_start_categ_id" />
                                 <field name="tip_product_id" />
                                 <field name="iface_tax_included" />
                             </group>
                             <group>
                                <field name="iface_big_scrollbars" />
                                <field name="iface_print_auto" />
                                <field name="iface_display_categ_images" />
                                <field name="iface_print_skip_screen"  attrs="{'invisible' : [('iface_print_auto', '=', False)]}" />
                                <field name="cash_control" />
                             </group>
                         </group>

                        <group string="Hardware Proxy / PosBox" >
                            <field name="proxy_ip" />
                            <field name="iface_print_via_proxy" string="Receipt Printer" on_change="onchange_iface_print_via_proxy(iface_print_via_proxy)"/>
                            <field name="iface_scan_via_proxy" string="Barcode Scanner"/>
                            <field name="iface_electronic_scale" />
                            <field name="iface_cashdrawer" />
                        </group>
                        <group name="receipt" string="Receipt Printer" >
                            <field name="receipt_header" string="Header" placeholder="A custom receipt header message"/>
                            <field name="receipt_footer" string="Footer" placeholder="A custom receipt footer message"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_lounge_config_tree">
            <field name="name">lounge.config.tree.view</field>
            <field name="model">lounge.config</field>
            <field name="arch" type="xml">
                 <tree string="Lounge Configuration">
                     <field name="name" />
                     <field name="stock_location_id" groups="stock.group_locations"/>
                     <field name="state" />
                 </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_lounge_config_search">
            <field name="name">lounge.config.search.view</field>
            <field name="model">lounge.config</field>
            <field name="arch" type="xml">
                <search string="Point of Lounge Config">
                    <field name="name" />
                    <filter string="Active" domain="[('state', '=', 'active')]" />
                    <filter string="Inactive" domain="[('state', '=', 'inactive')]" />
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_lounge_config_kanban">
            <field name="name">Point of Lounge</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">lounge.config</field>
            <field name="view_type">form</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="search_view_id" ref="view_lounge_config_search" />
            <field name="domain">[('state','=','active')]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to create a new Lounge config.
              </p><p>
                Configure at least one Point of Sale to be able to sell through the PoS interface.
              </p>
            </field>
        </record>

        <menuitem action="action_lounge_config_kanban"
                  parent="menu_lounge_root"
                  name="Dashboard"
                  id="menu_lounge_dashboard"
                  sequence="1"/>

        <menuitem name="Orders" id="menu_lounge_of_sale" parent="menu_lounge_root" sequence="10"/>

        <record model="ir.ui.view" id="view_lounge_session_search">
            <field name="name">lounge.session.search.view</field>
            <field name="model">lounge.session</field>
            <field name="arch" type="xml">
                <search string="Lounge Session">
                </search>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_lounge_session">
            <field name="name">Sessions</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">lounge.session</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_lounge_session_search" />
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to start a new lounge session.
              </p><p>
                A session is a period of time, usually one day, during which
                you sell through the point of sale. The user has to check the
                currencies in your cash registers at the beginning and the end
                of each session.
              </p><p>
                Note that you may use the menu <i>Your Session</i>
                to quickly open a new session.
              </p>
            </field>
        </record>

        <record model="ir.ui.view" id="view_lounge_session_form">
            <field name="name">lounge.session.form.view</field>
            <field name="model">lounge.session</field>
            <field name="view_type">form</field>
            <field name="arch" type="xml">
                <form string="Lounge Session">
                    <header>
                        <button name="open" type="workflow" string="Open Session"
                                attrs="{'invisible' : ['|', ('cash_control', '=', False), ('state', '!=', 'opening_control')]}"
                                class="oe_highlight"/>
                        <button name="open_frontend_cb" type="object" string="Continue Selling" states="opened"
                            class="oe_highlight"/>
                        <button name="cashbox_control" type="workflow" string="End of Session"
                            attrs="{'invisible' : ['|', ('cash_control', '=', False),('state', '!=', 'opened')]}"
                            class="oe_highlight" />
                        <button name="close" type="workflow" string="Validate Closing &amp; Post Entries"
                            attrs="{'invisible' : ['|', ('cash_control', '=', True),('state', '!=', 'opened')]}"
                            class="oe_highlight" />
                        <button name="close" type="workflow" string="Validate Closing &amp; Post Entries" states="closing_control"
                            class="oe_highlight" />
                        <field name="state" widget="statusbar" statusbar_visible="opening_control,opened,closing_control,closed" nolabel="1" />
                    </header>
                    <sheet>
                        <h1 class="oe_title">
                            Session:
                            <field name="name" attrs="{'invisible': [('name','=','/')]}" class="oe_inline"/>
                        </h1>
                         <group>
                             <field name="cash_control" invisible="1" />
                             <group>
                                <field name="user_id"/>
                                <field name="config_id"/>
                                <field name="rescue" attrs="{'invisible': [('rescue', '=', False)]}" />
                             </group>
                             <group>
                                 <!--attrs="{'invisible' : [('state', '=', 'opening_control')]}"-->
                                <field name="start_at" attrs="{'invisible' : [('state', '=', 'opening_control')]}" />
                                <field name="stop_at" attrs="{'invisible' : [('state', '!=', 'closed')]}"/>
                            </group>
                            <newline/>
                         </group>

                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_lounge_session_tree">
            <field name="name">lounge.session.tree.view</field>
            <field name="model">lounge.session</field>
            <field name="arch" type="xml">
                <tree string="Lounge Session">
                    <field name="config_id" />
                    <field name="name" />
                    <field name="user_id" />
                    <field name="start_at" />
                    <field name="stop_at" />
                    <field name="state" />
                </tree>
            </field>
        </record>

        <record id="product_lounge_template_action" model="ir.actions.act_window">
            <field name="name">Products</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">product.template</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,kanban</field>
            <field name="context" eval="{}"/>
            <field name="domain" eval="[('available_in_lounge','&lt;&gt;',False)]"/>
            <field name="search_view_id" eval="False"/> <!-- Force empty -->
            <field name="view_id" eval="False"/> <!-- Force empty -->
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a new product.
              </p><p>
                You must define a product for everything you sell through
                the point of sale interface.
              </p><p>
                Do not forget to set the price and the point of sale category
                in which it should appear. If a product has no point of sale
                category, you can not sell it through the point of sale
                interface.
              </p>
            </field>
        </record>

        <record id="product_template_form_view" model="ir.ui.view">
            <field name="name">product.template.form.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_form_view"/>
            <field name="arch" type="xml">
                <group name="sale_condition" position="after">
                    <group name="lounge" string="Lounge">
                        <field name="available_in_lounge"/>
                        <field name="lounge_categ_id" attrs="{'invisible': [('available_in_lounge', '=', False)]}"/>
                        <field name="lounge_to_weight" attrs="{'invisible': [('available_in_lounge', '=', False)]}"/>
                    </group>
                </group>
            </field>
        </record>

        <record id="product_template_tree_view" model="ir.ui.view">
            <field name="name">product.template.tree.inherit</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_tree_view"/>
            <field name="arch" type="xml">
                <field name="name" position="before">
                    <field name="sequence" widget="handle" />
                </field>
            </field>
        </record>

        <menuitem
                action="product_lounge_template_action"
                name="Products"
                parent="menu_lounge_of_sale"
                id="menu_lounge_product"
                sequence="5"/>

        <menuitem name="Configuration" parent="menu_lounge_root"
            id="menu_lounge_config" sequence="100"/>

        <record model="ir.actions.act_window" id="action_lounge_config_pos">
            <field name="name">Lounge</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">lounge.config</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_lounge_config_search" />
        </record>

        <!-- Product Public Services -->
        <record id="product_pos_category_form_view" model="ir.ui.view">
            <field name="name">lounge.category.form</field>
            <field name="model">lounge.category</field>
            <field name="view_type">form</field>
            <field name="arch" type="xml">
                <form string="Service Categories">
                    <sheet>
                        <field name="image_medium" widget='image' class="oe_avatar oe_right"/>
                        <div class="oe_left">
                            <group>
                                <field name="name"/>
                                <field name="parent_id"/>
                                <field name="sequence"/>
                            </group>
                        </div>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="product_lounge_category_tree_view" model="ir.ui.view">
            <field name="name">lounge.category.tree</field>
            <field name="model">lounge.category</field>
            <field name="field_parent" eval="False"/>
            <field name="arch" type="xml">
                <tree string="Product Product Categories">
                    <field name="sequence" widget="handle"/>
                    <field name="complete_name"/>
                </tree>
            </field>
        </record>



        <record id="product_lounge_category_action" model="ir.actions.act_window">
            <field name="name">Lounge Service</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">lounge.category</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" eval="False"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to define a new service.
              </p><p>
                Service are used to browse your products through the
                touchscreen interface.
              </p><p>
                If you put a photo on the service, the layout of the
                touchscreen interface will automatically. We suggest not to put
                a photo on categories for small (1024x768) screens.
              </p>
            </field>
         </record>

        <record id="action_account_lounge_journal_form" model="ir.actions.act_window">
            <field name="name">Payment Methods</field>
            <field name="res_model">account.journal</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context" eval="{'default_journal_user_lounge': 1, 'default_type': 'cash'}"/>
            <field name="domain">[('journal_user_lounge','=', 1)]</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to add a payment method.
              </p><p>
                Payment methods are defined by accounting journals having the
                field <i>Lounge Payment Method</i> checked. In order to be useable
                from the touchscreen interface, you must set the payment method
                on the <i>Lounge</i> configuration.
              </p>
            </field>
        </record>

        <menuitem name="Payment Method"
                  action="action_account_lounge_journal_form"
                  id="menu_action_account_lounge_journal_form_open"
                  parent="menu_lounge_config"
                  sequence="20"/>

         <menuitem name="Service Category"
                   action="product_lounge_category_action"
                   id="menu_product_lounge_category"
                   parent="menu_lounge_config"
                   sequence="20" />

        <menuitem
            parent="menu_lounge_config"
            action="action_lounge_config_pos"
            id="menu_pos_config_pos"
            />

        <menuitem
            name="Session"
            parent="menu_lounge_of_sale"
            action="action_lounge_session"
            id="menu_lounge_session_all"
            sequence="1"
            />

    </data>
</openerp>